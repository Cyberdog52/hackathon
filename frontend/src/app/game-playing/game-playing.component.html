<div class="component-wrapper">
  <button mat-raised-button [routerLink]="'/'">
    <mat-icon>arrow_back</mat-icon>
    Back to lobby browser
  </button>
  <ng-container *ngIf="gameState === gameStateEnum.END">
    <h1 *ngIf="gameWinnerId !== undefined">The winner is: <br/> {{this.player1Name}} ({{this.player1Id.substring(24)}})
    </h1>
  </ng-container>
  <ng-container *ngIf="gameState === gameStateEnum.LOBBY">
    <h1>Waiting for Players:</h1>
    <ul>
      <h2 *ngIf="this.player1Id">{{this.player1Name}} ({{this.player1Id.substring(24)}}) joined</h2>
      <h2 *ngIf="this.player2Id">{{this.player1Name}} ({{this.player2Id.substring(24)}}) joined</h2>
    </ul>
  </ng-container>
  <div *ngIf="player1Turn">
    It is your turn
    <span *ngIf="gameState === gameStateEnum.SETUP">, click to place your boats</span>
    <span *ngIf="gameState === gameStateEnum.PLAYING">, click to shoot a square!</span>
  </div>
  <div *ngIf="gameState === gameStateEnum.END">
    <span *ngIf="gameWinnerId === player1Id">You defeated you opponent!</span>
    <span *ngIf="gameWinnerId === player2Id">Your opponent won!</span>
  </div>
  <div *ngIf="player2Turn">Waiting for opponent</div>
  <div class="map-container" *ngIf="gameState !== gameStateEnum.LOBBY">
    <div class="map-wrapper">
      <h2>Player 1: <br/>{{this.player1Name}} ({{player1Id.substring(24)}})</h2>
      <app-map
        *ngIf="canRenderMap()"
        gameId="{{gameId}}"
        playerId="{{player1Id}}"
        [disabled]="gameState !== gameStateEnum.SETUP"
        [sizeX]=sizeX
        [sizeY]=sizeY
        #mapPlayer1
        (cellClick)="this.onCellClickPlayer1Map($event)"
      />
    </div>
    <div class="map-wrapper">
      <h2>Player 2: <br/> {{this.player2Name}} ({{player2Id.substring(24)}})</h2>
      <app-map
        *ngIf="canRenderMap()"
        [disabled]="gameState !== gameStateEnum.PLAYING && !this.player1Turn"
        gameId="{{gameId}}"
        playerId="{{player2Id}}"
        [sizeX]=sizeX
        [sizeY]=sizeY
        #mapPlayer2
        (cellClick)="this.onCellClickPlayer2Map($event)"/>
    </div>
  </div>
  <div class="action-bar" *ngIf="false">
    <label>
      Boat Size:
      <select (change)="changeBoatSize($event)">
        <option [selected]="boatType === boatTypeEnum.LARGE" value="{{boatTypeEnum.LARGE}}">3x</option>
        <option [selected]="boatType === boatTypeEnum.MEDIUM" value="{{boatTypeEnum.MEDIUM}}">2x</option>
        <option [selected]="boatType === boatTypeEnum.SMALL" value="{{boatTypeEnum.SMALL}}">1x</option>
      </select>
    </label>

    <label>
      Boat Orientation:
      <select (change)="changeBoatOrientation($event)">
        <option [selected]="boatDirection === boatDirectionEnum.UP" value="{{boatDirectionEnum.UP}}">Up</option>
        <option [selected]="boatDirection === boatDirectionEnum.DOWN" value="{{boatDirectionEnum.DOWN}}">Down</option>
        <option [selected]="boatDirection === boatDirectionEnum.LEFT" value="{{boatDirectionEnum.LEFT}}">Left</option>
        <option [selected]="boatDirection === boatDirectionEnum.RIGHT" value="{{boatDirectionEnum.RIGHT}}">Right</option>
      </select>
    </label>
  </div>
  <mat-expansion-panel hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Show Log output
      </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let evt of eventsClean$ | async;">
        <div *ngFor="let line of evt">
          {{line}}
        </div>
      </li>
    </ul>
  </mat-expansion-panel>
</div>
